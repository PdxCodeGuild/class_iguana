import random
import ast
import importlib



class Interaction:
    def __init__(self, coordinate, text, item, sym):
        self.coord = coordinate
        self.text_list = text 
        self.is_item = item
        self.symbol = sym

    
def random_item_gen():
    item_tups = []
    item_list = []

    while len(item_tups) < 10:
        item_pos = (random.randint(1,11), random.randint(2,8))      # tuple with x, y coordinates of item
        if item_pos not in item_tups and item_pos != (2,3):
            item_tups.append(item_pos)
    
    with open('lab26_item_gen.txt', 'r', encoding='utf-8') as file:
        for i, line in enumerate(file):
            item_list.append(line.strip() + ' *' + str(item_tups[i]))

    return item_list, item_tups


base = [['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],   
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n']
]

level_list = [
#          0  1   2     3     4     5     6     7     8     9     10    11  12  13
        [['','   ',' | ','   ','   ','   ','   ','   ','   ','   ',' | ',' U ','','\n'],
        ['','   ',' | ','  [',']  ',' []','   ','[] ','  [',']  ',' | ','   ','','\n'],
        ['','   ',' | ','   ','   ','   ','   ','   ','   ','   ',' | ','   ','','\n'],
        ['','   ',' | ','  [',']  ',' []','   ','[] ','  [',']  ',' | ','   ','','\n'],
        ['',' 0 ',' | ','   ','   ','   ','_ _','   ','   ','   ',' | ','   ','','\n'],
        ['','   ',' |_','__[',']__','__[','_|_',']__','__[',']__','_| ','   ','','\n'],   # Level 0
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n'],
        ['','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','','\n']
        ],

        [['-','---','---','---','---','---','===','---','---','---','---','---','-','\n'],
        ['|','|¯¯','ΞΞΞ','¯¯|','   ','   ','| |','   ','   ','ΞΞΞ','ΞΞΞ','¯¯|','|','\n'],
        ['|','| |','   ','|  ','ΞΞΞ','   ','| |','   ','|Ō|','   ','   ','| |','|','\n'],
        ['|','| |','   ','| |','   ','   ','| |','   ','|__','ΞΞΞ','¯ ¯','__|','|','\n'],
        ['|','| |','   ','|__','ΞΞΞ','ΞΞΞ','__|','   ','   ','   ','| |','   ','|','\n'],
        ['|','| |','   ','   ','   ','   ',' X ','ΞΞΞ','¯¯|','   ','|__','¯¯|','|','\n'],   # Level 1   Remove X!, Troubleshooting only
        ['|','| |','   ','   ','|¯¯','ΞΞΞ','¯¯|','   ','| |','   ','   ','| |','|','\n'],
        ['|','|__','ΞΞΞ','ΞΞΞ','  |','   ','| |','   ','| |','   ','   ','| |','|','\n'],
        ['|','   ','   ','   ','| |','   ','|  ','ΞΞΞ','ΞΞΞ','ΞΞΞ','ΞΞΞ','  |','|','\n'],
        ['|','|Ō|','   ','   ','| |','   ','| |','   ','   ','   ','   ','| |','|','\n'],
        ['|','|__','ΞΞΞ','ΞΞΞ','__|','   ','| |','   ','ΞΞΞ','ΞΞΞ','ΞΞΞ','__|','|','\n'],
        ['|','   ','   ','   ','   ','   ','|_|','   ','   ','   ','   ','   ','|','\n']
        ],

        [['-','---','---','---','---','---','===','---','---','---','---','---','-','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],   # Level 2
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','---','---','---','---','---','___','---','---','---','---','---','|','\n']
        ],

        [['-','---','---','---','---','---','===','---','---','---','---','---','-','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ',' ◭ ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],   # Level 3
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','---','---','---','---','---','___','---','---','---','---','---','|','\n']
        ],

        [['-','---','---','---','---','---','---','---','---','---','---','---','-','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ',' T ','   ',' T ','   ','   ','   ',' T ','   ',' T ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],   # Level 4
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ',' X ','   ','   ','   ','   ','   ',' X ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','   ','|','\n'],
        ['|','---','---','---','---','---','___','---','---','---','---','---','|','\n']
        ]
]


lvl3_list,_ = random_item_gen()
_, npc_pos = random_item_gen()
lvl3_objects = []

for item in lvl3_list:
    item_att = item.split('*')
    tup = ast.literal_eval(item_att[3])

    level_list[3][tup[1]][tup[0]] = item_att[2]
    item_att[0] = Interaction(tup, item_att[1], True, item_att[2])
    lvl3_objects.append(item_att[0])

for i in range(3):                                              # Make this change per entry into room
    level_list[2][npc_pos[i][1]][npc_pos[i][0]] = ' 0 '


npc1 = Interaction((1,4), 'Hello, World', False, ' 0 ')
trash = Interaction((11,0), 'This is a trash can. There\'s trash in here...', False, ' U ')

lvl1_obj1 = Interaction((8,2), 'obj1', True, ' o ')
lvl1_obj2 = Interaction((1,9), 'obj2', True, ' o ') 

npc2_1 = Interaction(npc_pos[0], 'Hello', False, ' 0 ')
npc2_2 = Interaction(npc_pos[1], 'Yellow', False, ' 0 ')
npc2_3 = Interaction(npc_pos[2], 'Cello', False, ' 0 ')

table1 = Interaction((2,2), 'Empty table...', False, ' T ') 
table2 = Interaction((4,2), 'Empty table...', False, ' T ')
table3 = Interaction((8,2), 'Empty table...', False, ' T ')
table4 = Interaction((10,2), 'Empty table...', False, ' T ')
tablet1 = Interaction((3,8), '[Tablet1 text]', False, ' X ')
tablet2 = Interaction((9,8), '[Tablet2 text]', False, ' X ')

level_objects = [
    {'doors' : [(6,5),(6,4)],       # level 0
    'special' : [npc1, trash],
    },
    {'doors' : [(6,0)],      # level 1
    'special' : [lvl1_obj1, lvl1_obj2],
    },
    {'doors' : [(6,0)],      # level 2
    'special' : [npc2_1, npc2_2, npc2_3],
    },
    {'doors' : [(6,0)],      # level 3
    'special' : lvl3_objects,
    },
    {'doors' : [],      # level 4
    'special' : [table1,table2,table3,table4,tablet1,tablet2],
    }
]



